{"version":3,"sources":["index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import {MetadataArgsStorage} from \"./metadata-builder/MetadataArgsStorage\";\nimport {importClassesFromDirectories} from \"./util/DirectoryExportedClassesLoader\";\nimport {RoutingControllerExecutor} from \"./RoutingControllerExecutor\";\nimport {ExpressDriver} from \"./driver/ExpressDriver\";\nimport {KoaDriver} from \"./driver/KoaDriver\";\nimport {Driver} from \"./driver/Driver\";\nimport {getFromContainer} from \"./container\";\nimport {RoutingControllersOptions} from \"./RoutingControllersOptions\";\n\n// -------------------------------------------------------------------------\n// Main Functions\n// -------------------------------------------------------------------------\n\n/**\n * Registers all loaded actions in your express application.\n */\nexport function useExpressServer<T>(expressApp: T, options?: RoutingControllersOptions): T {\n    createExecutor(new ExpressDriver(expressApp), options || {});\n    return expressApp;\n}\n\n/**\n * Registers all loaded actions in your express application.\n */\nexport function createExpressServer(options?: RoutingControllersOptions): any {\n    const driver = new ExpressDriver();\n    createExecutor(driver, options || {});\n    return driver.express;\n}\n\n/**\n * Registers all loaded actions in your koa application.\n */\nexport function useKoaServer<T>(koaApp: T, options?: RoutingControllersOptions): T {\n    createExecutor(new KoaDriver(koaApp), options || {});\n    return koaApp;\n}\n\n/**\n * Registers all loaded actions in your koa application.\n */\nexport function createKoaServer(options?: RoutingControllersOptions): any {\n    const driver = new KoaDriver();\n    createExecutor(driver, options || {});\n    return driver.koa;\n}\n\n/**\n * Registers all loaded actions in your express application.\n */\nfunction createExecutor(driver: Driver, options: RoutingControllersOptions): void {\n\n    // import all controllers and middlewares and error handlers (new way)\n    if (options && options.controllers && options.controllers.length)\n        importClassesFromDirectories(options.controllers);\n    if (options && options.middlewares && options.middlewares.length)\n        importClassesFromDirectories(options.middlewares);\n    if (options && options.interceptors && options.interceptors.length)\n        importClassesFromDirectories(options.interceptors);\n\n    // import all controllers and middlewares and error handlers (deprecated way)\n    if (options && options.controllerDirs && options.controllerDirs.length)\n        importClassesFromDirectories(options.controllerDirs);\n    if (options && options.middlewareDirs && options.middlewareDirs.length)\n        importClassesFromDirectories(options.middlewareDirs);\n    if (options && options.interceptorDirs && options.interceptorDirs.length)\n        importClassesFromDirectories(options.interceptorDirs);\n\n    if (options && options.developmentMode !== undefined) {\n        driver.developmentMode = options.developmentMode;\n    } else {\n        driver.developmentMode = process.env.NODE_ENV !== \"production\";\n    }\n\n    if (options.defaultErrorHandler !== undefined) {\n        driver.isDefaultErrorHandlingEnabled = options.defaultErrorHandler;\n    } else {\n        driver.isDefaultErrorHandlingEnabled = true;\n    }\n\n    if (options.useClassTransformer !== undefined) {\n        driver.useClassTransformer = options.useClassTransformer;\n    } else {\n        driver.useClassTransformer = true;\n    }\n\n    driver.classToPlainTransformOptions = options.classToPlainTransformOptions;\n    driver.plainToClassTransformOptions = options.plainToClassTransformOptions;\n\n    if (options.errorOverridingMap !== undefined)\n        driver.errorOverridingMap = options.errorOverridingMap;\n\n    if (options.routePrefix !== undefined)\n        driver.routePrefix = options.routePrefix;\n\n    // next create a controller executor\n    new RoutingControllerExecutor(driver)\n        .bootstrap()\n        .registerMiddlewares(false)\n        .registerActions()\n        .registerMiddlewares(true); // todo: register only for loaded controllers?\n}\n\n// -------------------------------------------------------------------------\n// Global Metadata Storage\n// -------------------------------------------------------------------------\n\n/**\n * Gets the metadata arguments storage.\n */\nexport function defaultMetadataArgsStorage(): MetadataArgsStorage {\n    return getFromContainer(MetadataArgsStorage);\n}\n\n// -------------------------------------------------------------------------\n// Commonly Used exports\n// -------------------------------------------------------------------------\n\nexport * from \"./container\";\nexport * from \"./decorator/controllers\";\nexport * from \"./decorator/decorators\";\nexport * from \"./decorator/methods\";\nexport * from \"./decorator/params\";\nexport * from \"./error\";\nexport * from \"./middleware/MiddlewareInterface\";\nexport * from \"./middleware/InterceptorInterface\";\nexport * from \"./middleware/ErrorMiddlewareInterface\";\nexport * from \"./RoutingControllersOptions\";\nexport * from \"./error/http/HttpError\";\nexport * from \"./error/http/InternalServerError\";\nexport * from \"./error/http/BadRequestError\";\nexport * from \"./error/http/ForbiddenError\";\nexport * from \"./error/http/NotAcceptableError\";\nexport * from \"./error/http/MethodNotAllowedError\";\nexport * from \"./error/http/NotFoundError\";\nexport * from \"./error/http/UnauthorizedError\";\n"],"sourceRoot":""}